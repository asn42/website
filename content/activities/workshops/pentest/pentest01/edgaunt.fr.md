+++
title = "write up de edgaunt"
weight = 0
aliases = ["activités/ateliers-pentest/pentest01/edgaunt"]
[extra]
author = "edgaunt"
points = 130
translations = [
    "activities/workshops/pentest/pentest01/edgaunt.en.md"
]
+++

Voici mes solutions pour les challenges de _*RickdiculouslyEasy*_

## Pour Commencer

Ces challenges sont d'un niveau débutant.
Je pars du principe que vous connaissez tous et toutes les commandes courantes
comme [ls](http://man7.org/linux/man-pages/man1/ls.1.html),
[cat](http://man7.org/linux/man-pages/man1/cat.1.html),
[file](http://man7.org/linux/man-pages/man1/file.1.html),
[tail](http://man7.org/linux/man-pages/man1/tail.1.html),
[strings](http://man7.org/linux/man-pages/man1/strings.1.html),
[tac](http://man7.org/linux/man-pages/man1/tac.1.html),
[...](http://man7.org/linux/man-pages/man1/man.1.html)

Toutefois il est quand même recommandé de connaitre un peu le
[python](https://www.python.org/doc/) et de connaitre les commandes
suivantes&nbsp;:

- [nc](https://linux.die.net/man/1/nc)
- [unicornscan](https://linux.die.net/man/1/unicornscan)
- [hydra](https://tools.kali.org/password-attacks/hydra)
- [ftp](https://linux.die.net/man/1/ftp)
- [dirb](https://tools.kali.org/web-applications/dirb)
- [patator](https://tools.kali.org/password-attacks/patator)

### Conditions préalables

- **Installer [Vmware](https://my.vmware.com/en/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation_pro/14_0) ou [Virtualbox](https://www.virtualbox.org/wiki/Downloads)**
- **Installation de l'[iso](http://pentest01.sansnom.org) dans une VM**
- **Installation de [Kali](https://www.kali.org/downloads/) ou d'une [image](https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-hyperv-image-download/)**

### Installation

Personnellement j'ai utilisé Virtualbox et j'ai configuré le réseau de l'iso
en bidge. Vous êtes libre de l'utiliser comme bon vous semble comme
`NAT Network` ou autres. Si vos êtes comme moi et avait opté pour Virtualbox,
n'oublier pas d'installer le paquet d'extension pour plus de confort et éviter
des problèmes d'installation&nbsp;!

## Resolution des Challenges

L'adresse de notre cible est indiqué sur la VM qui tourne sur Virtualbox.

![Adresse](/images/adresse_cible.png)

On va donc commencer par scan un peu tout ça avec la commande&nbsp;:

``` sh
unicornscan -v -I -r 1000 -p 1-65535 192.168.1.15
```

![cmd_unicornscan](/images/unicornscan_cmd.png)

On peut voir ici qu'il y a plusieurs points d'entrée.

Pour les fan de [nmap](https://linux.die.net/man/1/nmap).
Une autre solution aurait été de lancer `nmap 192.168.1.17 -O -sV -p- -T5`

On va donc faire un petit [nc](https://linux.die.net/man/1/nc)
sur chacune des zones que l'on a trouvées&nbsp;:

``` sh
nc -nv 192.168.1.15 60000
```

![nc_cmd_port_60000](/images/nc_cmd_60000.png)

Ici on peut voir que ce petit filou de Rick nous a laissé une petite backdoor.

Un autre option aurait été d'utiliser la commande
 [telnet](https://linux.die.net/man/1/telnet) comme cela&nbsp;:

``` sh
telnet 192.168.1.15
```

On va donc regarder ce que l'on trouve dans cette zone avec la commande
[ls](http://man7.org/linux/man-pages/man1/ls.1.html).
On vient de trouver un fichier `FLAG.txt`. On lance donc un
[cat](http://man7.org/linux/man-pages/man1/cat.1.html) dessus et BINGO
*{Flip the pickle Morty!}*&nbsp;! Ce qui nous fait 10 / 130 points.

``` sh
nc -nv 192.168.1.15 22222
```

![nc_cmd_port_22222](/images/nc_cmd_22222.png)

Ici pas de flag. Par contre on peut voir que ce port sert à se connecter en
[ssh](https://linux.die.net/man/1/ssh) . Si jamais on trouve des identifiants
au cours de notre exploration, on va surement pouvoir utiliser ce port pour se
connecter&nbsp;!

``` sh
nc -nv 192.168.1.15 13337
```

![nc_cmd_port_13337](/images/nc_cmd_13337.png)

On a directement un flag qui s'affiche *{TheyFoundMyBackDoorMorty}*&nbsp;!
 ce qui nous fait à présents 20 / 130 points.

Bien maintenant que l'on a fait les `unknown`. On va passer aux classiques.
Comme dit sur la VM qui run l'iso et sur notre commande
[unicornscan](https://linux.die.net/man/1/unicornscan) on voit que l'on peut
se connecter depuis un brother a l'adresse `https://192.168.1.15:9090`.
Une fois rendu sur cette page on peut constater que l'on a un autre flag
*{THERE IS NO ZEUS, IN YOUR FACE!}*. On arrive donc à 30 / 130 points.

<!---
url link img
-->
![web_home](/images/connection_home.png)

Passons maintenant à la connexion FTP. Pour cela on va utiliser
[hydra](https://tools.kali.org/password-attacks/hydra) pour brut forcé
histoire de voir si par megarde il n'y aurait pas un accès. On va donc lancer
la commande&nbsp;:

``` sh
hydra -V -f -L /usr/share/worldlists/dirb/ltl.txt -P /usr/share/worldlists/dirb/ltl.txt ftp://192.168.1.15
```

<!---
url link img
-->
![hydra_result](/images/hydra_result.png)

J'ai utilisé mon propre custom file mais il existe beaucoup de fichiers plus
ou moins gros pour tester ces connexions-là.
Au bout de quelques minutes nous avons trouvé un match. Ni une, ni deux, on va
pouvoir voir si l'on trouve quelque chose.
On lance donc la connexion avec `ftp -p 192.168.1.15`, on se retrouve donc à
rentrer les logins et password trouver.
Une fois connecter on lance notre,
[ls](http://man7.org/linux/man-pages/man1/ls.1.html) et encore une fois on voit
un fichier `FLAG.txt`.

![ftp_cmd](/images/ftp_cmd.png)

On va donc regarder ce qu'il y a dedans avec `get FLAG.txt /dev/tty` et nous
voilà maintenant en possetion d'un nouveau flag *{Whoa this is unexpected}* ce
qui nous monte maintenant à 40 / 130 points.

On va maintenant commencer à essayer de voir si l'on ne trouve pas certains
accès sur le site. Comme on n'aime pas attendre on va accélérer les choses
avec la commande [dirb](https://tools.kali.org/web-applications/dirb).
On lance donc la commande suivante&nbsp;:

``` sh
dirb http://192.168.1.15 /usr/share/worldlists/dirb/big.txt -N 404
```

![dirb_cmd](/images/dirb_cmd.png)

On a des resultat&nbsp;:
- `cgi-bin/`
- `passwords/`
- `robots.txt`

`http://192.168.1.15/cgi-bin/` n'est pas très concluant. on se retrouve avec un
 `Forbidden` et rien dans le code source de la page :/.

![forbidden_acces](/images/forbidden_acces.png)

![forbidden_source](/images/forbidden_source.png)

Essayons maintenant avec la directory `http://192.168.1.15/passwords/`
![passwords](/images/passwords.png)

Ah plus de chance cette fois avec cette Directory&nbsp;! On y retrouve deux
fichiers&nbsp;:

- `FLAG.txt`.
- `passwords.html`.

![password_flag](/images/password_flag.png)

On va d'abord regarder le contenue du fichier `FLAG.txt` affin de récupère un
notre nouveau flag qui est *{Yeah d- just don't do it.}* ce flag étant à 10
nous sommes donc maintenant a 50 / 130 points.

![passwords_passwords](/images/passwords_passwords.png)

Maintenant allons regarder le fichier `passwords.html`. Il n'y a rien de
spécial sur cette page. Par contre si l'on regarde le code source on peut
trouver écrit en commentaire la phrase `Password: winter`.

Pas moyen de l'utiliser pour l'instant mais on a récupéré un mot de passe et ça
c'est toujours cool&nbsp;!

Passons maintenant au `robots.txt`

![robots](/images/robots.png)

Super&nbsp;! Finalement on va pouvoir allez les
[cgi](https://en.wikipedia.org/wiki/Common_Gateway_Interface).

On voit qu'il y a donc deux fichiers&nbsp;:

- `cgi-bin/root_shell.cgi`.
- `cgi-bin/tracertool.cgi`.

![root_shell_cgi](/images/root_shell_cgi.png)

On commence donc par l'url du root_shell par ce que les root_shell c'est
cool&nbsp;!
Manque de chance Rick est vraiment un *trou du cul* car il n'a pas fini de le
coder :/.

On va donc passer au tracertool.Et là il nous proposait d'entrer une adresse ip
pour la tracer. Comme on est des personnes sérieuses qui écoutent ce que l'ont
nous demande. On va essayer de voir à tout hasard il ne nous laisserait pas
renter d'autre commande en rajoutant un `;` au debut, pour exécuter une autre
commande.

On s'applique donc à lancer la commande suivante&nbsp;:

``` sh
; ls -la
```

![ls_tracertool_cgi](/images/ls_tracertool_cgi.png)

Chouette ce n'est pas proteger. On essaye donc&nbsp;:

``` sh
; cat /etc/passwd
```

![cat_tracertool_cgi](/images/cat_tracertool_cgi.png)

... On dirais bien qu'il se protege contre la commande
 [cat](http://man7.org/linux/man-pages/man1/cat.1.html).
 On va donc essayer avec
 [tac](http://man7.org/linux/man-pages/man1/tac.1.html)&nbsp;!

 ``` sh
 ; tac /etc/passwd
 ```

![tac_tracertool_cgi](/images/tac_tracertool_cgi.png)

Nickel&nbsp;! Si vous vous rappelez bien, nous avions trouvé un mot de passe
avant.
Et bien maintenant que l'on a récupéré la liste des users on va pouvoir essayer
de faire match ce mot de passe avec l'un des users. Vue qu'il n'y a que trois
utilisateurs j'ai essayé directement a la main et la Summer m'a ouvert son
coeur&nbsp;:

 ``` sh
 ssh -p 22222 Summer@192.168.1.15
 ```

![connection_summer](/images/connection_summer.png)

Commencons par le commencement, un petit
[ls](http://man7.org/linux/man-pages/man1/ls.1.html), nous révèle que l'on a
un nouveau fichier `FLAG.txt`.
On lance donc notre `tail FLAG.txt` et un nouveau flag pour nous grace au flag
*{Yeah d- just don't do it.}* + 10 points.
Ce qui nous fait monter à 60 / 130 points.

![ls_tailf_flag](/images/ls_tailf_flag.png)

Maintenant que nous sommes connectés en [ssh](https://linux.die.net/man/1/ssh)
on va pouvoir allez voir ce qu'on Morty est Rick dans leurs Home.
On va donc fait la commande suivante avec le User `Summer`&nbsp;:

``` sh
clear ; cd /home/Morty ; ls -la
```

![ls_morty_home](/images/ls_morty_home.png)

On trouve donc deux fichiers&nbsp;:

- `journal.txt.zip`.
- `Safe_password.jpg`.

On va essayer de regarder ce que l'on peut faire de ça. On va donc lancer la
 commande suivante avec le user `Summer`&nbsp;:

``` sh
cp journal.txt.zip Safe_password.jpg /home/Summer/. ; cp Safe_password.jpg /tmp/.
 ; chown Summer /tmp/Safe_password.jpg
```

On constate que le fichier zip est protégé par un mot de passe. Coïncidence
avec le faite qu'il soit accompagné d'un fichier de mot de passe. Je ne crois
pas&nbsp;!
Mais sait on jamais. On va la copier pour pouvoir l'ouvrir sur notre ordinateur
car lire une image sur un terminal n'est pas vraiment lisible pour un humain.
On lance commande suivante&nbsp;:

``` sh
scp -P 22222 Summer@192.168.1.15:/tmp/Safe_password.jpg .
```

On ouvre donc le fichier et là `>_..._<`, rien d'ecrit sur l'image.

![rick_img](/images/rick_img.png)

On va donc lancer la commande

``` sh
strings Safe_password.jpg
```

![strings_pwd](/images/strings_pwd.png)

Génial, Rick a été malin et sait que Morty est un peu stupide. Du coup il lui a
 clairement écrit le mot de passe pour
 [unzip](https://linux.die.net/man/1/unzip) le fichier&nbsp;!

On retourne sur la connexion [ssh](https://linux.die.net/man/1/ssh) et on
essaye le mot de passe&nbsp;:

![unzip_txt](/images/unzip_txt.png)

Parfait&nbsp;! Morty nous confits que c'est un mot de passe a Rick et nous
avons maintenant un nouveau Flag *{131333}* et celui la est a 20 points. On en
est maintenant a 80 / 130 points.

Allons faire un tour chez Rick maintenant que Morty nous a reveler tous ces
secrets.
On y retrouve deux Folders&nbsp;:

- `RICKS_SAFE`
- `ThisDoesntContainsAnyFlags`

![unzip_txt](/images/home_rick.png)

À première vue le fichier `NotAFlag.txt` n'est pas un flag. Par contre le
fichier `safe` est deja plus interessant. On se rend compte que c'est un
exécutable. On veut pouvoir faire mumuse avec, alors nous allons le copier
dans notre home puis l'exécuter.

``` sh
cp /home/RickSanchez/RICKS_SAFE/safe /home/Summer/. ; cd ; ./safe
```

![run_safe](/images/run_safe.png)

Ça y est&nbsp;! Vous aussi vous faites la relation avec ce que ce bon vieux
Morty a dit&nbsp;?
Très bien réessayons mais avec comme premiers arguments 131333.

![decrypt_succes](/images/decrypt_succes.png)

On touche au but&nbsp;! En plus d'avoir trouvé  le flag
*{And Awwwaaaaayyyy We Go!}* qui nous fait avoir 20 points en plus et donc
arriver a 100 / 130 points ; il nous explique même comment se connecter avec
RickSanchez en [ssh](https://linux.die.net/man/1/ssh)&nbsp;!

![Wiki_rick](/images/Wiki_rick.png)

Comme Tout le monde le sait le groupe de Rick était `The Flesh Curtains`,
 mais dans le doute on a quand même vérifier sur
 l'internet. Il ne nous reste plus qu'à écrire un
 petit script.

``` sh
cat > generator_mdp.py
import string
grp_name = ("The", "Flesh", "Curtains")
with open("mdp.txt", 'w') as f:
    for l in string.uppercase:
        for d in string.digits:
            for g in grp_name:
                f.write(l + d + g + '\n')
```

Maintenant qu'on a notre script on va générer toutes les combinaisons de
 mot de passe puis essayer de retrouver le mot de passe grâce à
 [patator](https://tools.kali.org/password-attacks/patator).

``` sh
python generator_mdp.py ; patator ssh_login user=RickSanchez host=192.168.1.14 port=22222 password=FILE0 0=mdp.txt -x ignore:mesg='Authentication failed.'
```

Et on a notre mot de passe. Essayons de nous connecter en
[ssh](https://linux.die.net/man/1/ssh) en rentrant ce mot de passe

![ssh_rick_connection](/images/ssh_rick_connection.png)

``` sh
ssh -p 22222 RickSanchez@192.168.1.15
```

Maintenant que nous sommes OFFICIELLEMENT RickSanchez nous pouvons lancer la
commande `sudo su` avec le même mot de passe et ainsi passé Root.

![root_dir](/images/root_dir.png)

On retrouve notre dernier flag *{Ionic Defibrillator}* pour une valeur de 30
points ce qui nous amènent à 130 sur 130 points&nbsp;!

![last_flag](/images/last_flag.png)

Bravo à toutes et à tous d'avoir réussi ces challenges&nbsp;:)
